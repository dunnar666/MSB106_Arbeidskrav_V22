---
title: "Arbeidskrav våren 2022"
author:
- Kevin Ha
- Ola Andre Olofsson
- Ann Elisabeth Jacobsen
- Heidi Marie Rolfsnes
- Daniel Karstad
- Henriette Hansen
- Susann Birkeland Sivertsen
- Vilde Haugland
subtitle: MSB106, Anvendt by- og regionaløkonomi
output:
  pdf_document: default
  html_notebook: default
  html_document:
    df_print: paged
lang: no-NB
editor_options: 
  markdown: 
    wrap: sentence
---

```{r setup, include=FALSE}
suppressPackageStartupMessages({
  library(readr)
  library(ggplot2)
  library(knitr)
  library(viridis)
  library(tidyverse)
  library(kableExtra)
  })
knitr::opts_chunk$set(echo=FALSE, include = TRUE)
```

# Romlige forskjeller i næringsstruktur, virkninger av eksogene sjokk i basissysselsettingen, og lokale forskjeller I sysselsettingsvekst.

I denne oppgaven vil vi se på næringsstrukturer på Haugalandet, Sunnhordland og Hardanger.

Problemstillinger og beregninger vi vil se nærmere på

-   Beskrive situasjonen slik den er for 2020, og for utviklingen over tid.
-   Sysselsettingsutviklingen for ulike næringer i ulike kommuner og for regionen samlet.
-   Andelen av sysselsettingen innenfor enkeltnæringer, og sammenligne situasjonen og utviklingen for lokale kommuner og lokal region med det som gjelder for nasjonen samlet.
-   Beregne lokaliseringskvotienter for ulike næringer i ulike kommuner, og for regionen(e) samlet.
-   Beregne ulike aggregeringsnivåer av næringer og geografi, identifiser mulige klynger basert på verdiene for lokaliseringskvotientene.
-   Gjøre en vurdering av hvor konsentrert/spredt en næring er fordelt mellom kommunene i regionen, basert på beregninger av den romlige Gini-indeksen.
-   Vurdere om sammenligningsgrunnlaget bør være samlet sysselsetting i regionen, eller samlet sysselsetting av nasjonen, og finne ut hvilken rolle det spiller om en bruker regionale eller nasjonale anslag for samlet sysselsetting.
-   Finne ut om næringsstrukturen i regionen har blitt mer eller mindre diversifisert, mangfoldig, over tid.
-   Beregne en regional mangfold-indeks og finne ut hvordan verdiene på en slik indeks er endret over tid.
-   Vurdere om sysselsettingsandelene skal sammenlignes med nasjonale eller regionale andeler for de ulike næringene
-   Gjenta beregninger for andeler av arbeidstakere i ulike næringer, lokaliseringskvotienter, den romlige Gini- koeffisienten og målet for mangfold av næringer, med utgangspunkt i data spesifisert etter arbeidstakernes bosted.
-   Sammenligne resultatene for data etter arbeidssted, og kommenter hvilken informasjon resultatene gir om romlig mobilitet i arbeidsmarkedet.
-   Gi en kort oversikt over pendlerstrømmer mellom kommunene i regionen
-   Beregne og presentere andeler av arbeidstakere med bosted i en kommune som har arbeidssted i andre kommuner, og gjør det samme for andelen av jobbene i en kommune som er besatt av arbeidstakere fra andre kommuner.
-   Diskutere forskjeller mellom kommunene i regionen, og drøft utviklingen over tid for ulike kommuner
-   Beregne og presentere andelen av arbeidstakere som bor og jobber innenfor samme kommune. Se om det er systematiske forskjeller sett i forhold til sentralitet og tilgjengelighet i det lokale arbeidsmarkedet. Og om det er bestemte trender i utviklingen for ulike kommuner.
-   Bruke beregningene av lokaliseringkvotienter til å dele næringene inn i lokal- og basisnæringer
-   Formulere en økonomisk basemodell og beregne økonomiske basemuliplikatorer for enkeltkommuner og region(er).
-   Vurdere lokale virkninger av alternative lokaliseringer i Odda, Husnes og Leirvik
-   Drøfte virkninger av et slikt positivt eksogent sjokk for den lokale økonomien gjennom bruk av en basemodell
-   Finne ut hvordan virkningene eventuelt spres til andre kommuner i regionen og hvordan en kan bruke data for pendlestrømmer til å predikere virkninger på sysselsettingen i ulike kommuner.
-   Sammenligne disse prediksjonene med de vi får når vi gjennomfører analysen på regionalt nivå.
-   Gi en shift-share analyse i en diskusjon av forskjeller i vekst for eksempel mellom indre, midtre og ytre deler av regionen, eller eventuelt områder/kommuner som har hatt sterk og svak befolkningsutvikling.

## Oversikt over befolkningene i regionene

### Haugalandet
Haugalandet består av kommunene Bokn (852), Haugesund (37357), Karmøy (42186), Sauda (4595), Tysvær(11065), Utsira(198) og Vindafjord(8714). tilsammen bor det 104967 personer i denne regionen. i tidsperioden vi har hentet inn data har det vert kommunesammenslåing i denne regionen. Da ble Ølen og vindafjord slått i sammen til en kommune (hvordan har vi tatt hensyn til dette???)

### Sunnhordland og Ullensvang
Sunnhordland og Ullensvang består av kommunene Bømlo(11957), Etne(4062), Fitjar(3189), Kvinnherad(13071), Stord(18759), Sveio(5766), Tysnes(2869) og Ullensvang(11048). Tilsammen bor det 70721 personer i denne regionen.

Tallene er hentet fra SSB 09.01.21 (https://www.ssb.no/statbank/table/01223/tableViewLayout1/) gjelder for 4 kvartal 2020.

```{r csv_filer}
syssel_arb <- read_csv("Data/syssel_arb.csv", show_col_types = FALSE)
hld_arb <- read_csv("Data/hld_arb.csv", show_col_types = FALSE)
sun_arb <- read_csv("Data/sun_arb.csv", show_col_types = FALSE)
har_arb <- read_csv("Data/har_arb.csv", show_col_types = FALSE)
syssel_bos <- read_csv("Data/syssel_bos.csv", show_col_types = FALSE)
hld_bos <- read_csv("Data/hld_bos.csv", show_col_types = FALSE)
sun_bos <- read_csv("Data/sun_bos.csv", show_col_types = FALSE)
har_bos <- read_csv("Data/har_bos.csv", show_col_types = FALSE)
Pendling <- read_csv("Data/Pendling.csv", show_col_types = FALSE)
hgl_Pendling <- read_csv("Data/hgl_Pendling.csv", show_col_types = FALSE)
sun_Pendling <- read_csv("Data/sun_Pendling.csv", show_col_types = FALSE)
```

# 1 Sysselsetting i ulike næringer, etter arbeidssted

## Haugalandet

Første regionen vi velger å se på er Haugalandet. Her ønsker vi å se på utviklingen fra 2008 til 2020, av antall ansatte i sin helhet i regionen, samt de 6 mest relevante næringene.

```{r Arbeidssted_Haugalandet_1}
hld_arb %>% 
  ggplot(mapping = aes(x = År, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Fig. 1: Haugalandet")+
  ylab("Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+
  scale_x_continuous(breaks = seq(2008, 2020, by = 1))
```

I 2020 er det i underkant av 50 000 ansatte i alle næringer på Haugalandet. Av Fig. 1 ser vi at Haugalandet fikk en nedgang i antall ansatte i 2015 og 2016. I 2017 og 2018 ble det vekst, frem til det snudde i 2019 igjen.

```{r Arbeidssted_Haugalandet_2}
syssel_arb %>% 
  filter(knr %in% c(1106, 1135, 1145, 1146, 1149, 1151, 1160)) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = `Alle Næringer`, (angle=0))) +
  scale_fill_distiller(palette = "Dark2") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  labs(title = "Fig. 2: Haugalandet", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+
  theme(legend.position = 'bottom')
```

I Fig. 2 ser vi at flere av kommunene på Haugalandet har hatt liten arbeidsplassvekst, med unntak av Tysvær, Vindafjord og Karmøy i den siste tiårsperioden. Vi ser dette mer tydelig på fig. 3 og 4.

```{r hld_arb_long}
hld_arb_long <- syssel_arb %>%
  pivot_longer(
    cols = `Alle Næringer`:Uoppgitt,
    names_to = "Næring",
    values_to = "Ansatte")
```

```{r Næring_Total_Haugalandet_3_Største_Arbeidsted}
hld_arb_long %>% 
  filter(knavn %in% c("Haugesund", "Karmøy", "Vindafjord")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = aar, y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. 3: Haugalandet: Haugesund, Karmøy og Vindafjord", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom') + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 2)) + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

```{r Næring_Total_Haugalandet_4_Minste_Arbeidsted}
hld_arb_long %>% 
  filter(knavn %in% c("Bokn", "Sauda", "Tysvær", "Utsira")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = aar, y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. 4: Haugalandet: Bokn, Sauda Tysvær og Utsira", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom') + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 2)) + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

Figur 3 og 4 viser utviklingen av det totale antall ansatte i alle næringer på kommunalt nivå, innenfor Haugaland-regionen.

I disse figurene, så ser vi tydelig at Haugesund har hatt reduksjon i antall ansatte totalt sett, mens Karmøy, Vindafjord og Tysvær har hatt en markant vekst de siste ti årene. Siden Haugesund har flest arbeidsplasser betyr utviklingen i Haugesund mye for de samlede tallene.

```{r Næringsfordeling_og_Utvikling_Haugelandet_3_Største_Arbeidssted}
hld_arb_long %>% 
  filter(knavn %in% c("Haugesund", "Karmøy", "Vindafjord")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Fig. 5: Haugalandet: Haugesund, Karmøy og Vindafjord", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom')
```

```{r Næringsfordeling_og_Utvikling_Haugelandet_4_Minste_Arbeidssted}
hld_arb_long %>% 
  filter(knavn %in% c("Bokn", "Sauda", "Tysvær", "Utsira")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Fig. 6: Haugalandet: Bokn, Sauda, Tysvær og Utsira", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

Figur 5 og 6 viser utviklingen av de 6 mest relevante næringene i Haugalandsregionen på kommune nivå.

Vi ser i de tre største kommunene, Haugesund, Karmøy og Vindafjord utgjør næringene Helse- og Sosialtjenester og Industri de største. Helse- og Sosialtjenester har vokst jevnt og trutt de siste tiårene, mens antall ansatte i industrinæringen har variert fra kommune til kommune. I Haugalandet utgjør primærnæringer (jordbruk, Skogbrug og Fiske) en større andel, enn hos Karmøy og Haugesund hvor primærnæringene kun utgjøre en liten andel.

### Sysselsettingsutviklingen for ulike næringer i ulike kommuner og for regionen samlet. 

Det er relativt store kommunevise forskjeller i næringsstrukturen.
Rogaland har en forholdsvis ensidig næringsstruktur, olje og gass er dominerende. Fylket er suverent dominerende for fossil energi. De har for øvrig de siste årene satset på et en mer differensiert næringsstruktur og næringsliv ved å satse på helse, IKT og fornybar energi.

I våre modeller, er satsingen på helse den mest tydelige. Av rent tekniske grunner er det vanskelig å se utviklingen i enkelte næringer som utgjør små andeler, på grunn av skalaen som er benyttet. Til tross for dette, kan man se at næringsstrukturen i regionen samlet generelt sett har endret seg lite.

Rogaland har gode jordbruksmuligheter, men i Fig. 2: Haugalandet ser vi en nedgang i sysselsettingen de siste tiårene, mens det er en marginal økning i Sunnhordaland, jf. Fig 9. I Fig. 12: ser vi at Tysnes har hatt en markant økning i primærnæringen, relativt sett.

Universitets- og høgskolesektoren er liten i Rogaland, og den består for det første av Universitetet i Stavanger (UiS) og Høgskulen på Vestlandet (HVL) med campus Haugesund.

Haugaland Vekst, som er eigd/drevet av Haugalandsregionen er i spissen på å legge til rette for å etablere ny industri samt andre arbeidsplasser i regionen.

I helsesektoren er Stavanger universitetssykehus (SuS) sentralt.

## Sunnhordland

Videre ønsker vi å se på den samme utviklingen, men denne gangen i Sunnhordlandsregionen.

```{r Arbeidssted_Sunnhordland_1}
sun_arb %>% 
  ggplot(mapping = aes(x = År, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Fig. 7: Sunnhordaland", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+ 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1))
```

Her viser figur 7 utviklingen til den totale summen av ansatte i Sunnhordlandsregionen fra 2008 til 2020. Sunnhordaland har i 2020 i underkant av 25 500 ansatte. Vi ser ut ifrå figuren at Sunnhordlandsregionen hadde ein markant vekst ifrå 2008 til 2014 med periodar med svak nedgang. Fra 2014 har det vært en reduksjon i totalt antall ansatte.

```{r Arbeidssted_Sunnhordland_2}
syssel_arb %>% 
  filter(knr %in% c(4611, 4612, 4613, 4614, 4615, 4616, 4617)) %>% 
  ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  scale_fill_distiller(palette = "Dark2") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
   labs(title = "Fig. 8: Sunnhordland", x = "År") +
  theme(legend.position = 'bottom')
```

Figur 8 viser utviklingen av totalt ansatte i Sunnhordlandsregionen på kommunenivå i hele regionen fra 2008 til 2020. Denne figuren gir oss en oversikt, men er ikke heilt brukervennelig. Vi lager dermed en mer oversiktlig figur, jf. figur 9 & 10.

```{r sun_arb_long}
sun_arb_long <- syssel_arb %>%
  pivot_longer(
    cols = `Alle Næringer`:Uoppgitt,
    names_to = "Næring",
    values_to = "Ansatte")
```

```{r Næring_Total_Sunnhordland_3_Største_Arbeidsted}
sun_arb_long %>% 
  filter(knavn %in% c("Bømlo", "Kvinnherad", "Stord")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = aar, y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. 9: Sunnhordland: Bømlo, Kvinnherad og Stord", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom') + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 2)) + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

```{r Næring_Total_Sunnhordland_4_Minste_Arbeidsted}
sun_arb_long %>% 
  filter(knavn %in% c("Etne", "Fitjar", "Sveio", "Tysnes")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = aar, y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. 10: Sunnhordland: Etne, Fithar, Sveio og Tysnes", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom') + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 2)) + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

Vi ser her ut ifra figur 9 og 10 utviklingen for hver enkelt kommune i Sunnhordland totalt sett, og her ser vi mye tydligere utviklingen fra 2008 til 2020. En kan se her at Kvinnherad, Etne og Fitjar har hatt en reduksjon i totalt ansatte, mens Tysnes og Sveio har hatt ein kraftig vekst. En interessant bemerking er Stord i 2014 og Kvinnherad fra 2008 til 2017.

For å få et bedre oversikt over utviklingen i kommunen ønsker vi å se på de 6 mest relevante næringene i hver kommune.

```{r Næringsfordeling_og_Utvikling_Sunnhordland_3_Største_Arbeidssted}
sun_arb_long %>% 
  filter(knavn %in% c("Bømlo", "Stord", "Kvinnherad")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = aar, y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Fig. 11: Sunnhordland: Bømlo, Kvinnherad og Stord", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom') + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 2)) + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

```{r Næringsfordeling_og_Utvikling_Sunnhordland_4_Minste_Arbeidssted}
sun_arb_long %>% 
  filter(knavn %in% c("Etne", "Sveio", "Fitjar", "Tysnes")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Fig. 12: Sunnhordland: Etne, Fitjar, Sveio og Tysnes", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

Figur 11 og 12 viser de 6 mest relevante næringene i hver enkelt kommune i Sunnhordlandsregionen fra 2008 til 2020.

En ser ut ifra figur 11 at i de tre største kommunene, *Bømlo*, *Kvinnherad* og *Stord* så har de alle hatt en reduksjon i industrien, samtidig som de har hatt en vekst i helse- og sosialtjenester. Tysnes har vært stabil når det kommer til industri, men har sett ein markant vekst i primærnæringen (Jordbruk, Skogbruk og Fiske).

### Sysselsettingsutviklingen for ulike næringer i ulike kommuner og for regionen samlet.

Det første bemerkelsesverdige i Sunnhordlandsregionen er den markante reduksjonen i industri i Stord kommune i 2014, samt Kvinnherad fra 2008. Dette stemmer overens med to hendelser. Den første er oljeknekken i 2014 som medførte at bl.a. Aker Stord AS som er avhengig av Olje-industrien måtte permitere.

Stord er en kommune som har mye offshore industri. I 2008/2009 så stengte Sør-Norge Aluminium "B-Hallen" som medførte 50% reduksjon i produksjon, og dermed ansatte. Interessant å bemerke at i Kvinnherad så er antall industriarbeidere redusert samtidig som antall ansatte i Helse- og Sosialetjenester økt. Bømlo har også sett en stabil reduksjon i ansatte innen industri, samt vekst i Helse- og Sosialetjenester frem til 2018.

Ser en på hele Sunnhordlandsregionen i sin helhet, så ser vi en svært tydelig vekst innen Helse- og Sosialetjenester, og reduksjon innen industri i hele regionen. Kvinnherad, Tysnes og Fitjar har opplevd ein markant vekst innen primærnæring. **Kan det vere ein grunn til dette som burde diskuterast??**

# Fortsett Her (OA, KH)

## Hardanger

Til slutt må vi gjere det samme med *Hardanger*

I henhold til oppgavens krav til betrakter vi *Hardanger* før 2019 som Ullensvang- og Odda kommune som to separerte kommuner. i 2020 så ble Ullensvang, Odda og Jondal slått sammen til Ullensvang. Dette forklarer den voldsomme økningen i sysselsetting i regionen ved tidspunktet for kommunesammenslåing.

```{r Arbeidssted_Hardanger_1}
har_arb %>% 
  ggplot(mapping = aes(x = År, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Fig. 13: Hardanger", y= "Alle Næringer") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 2))
```

```{r Arbeidssted_Hardanger_2}
syssel_arb %>% 
  filter(knr %in% c(4618, 1228)) %>% 
  ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  scale_fill_distiller(palette = "Dark2") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_color_manual(values=c('#111111','#054987')) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
   labs(title = "Fig. 14: Hardanger", x = "År") +
  theme(legend.position = 'bottom')
```

```{r har_arb_long}
har_arb_long <- syssel_arb %>%
  pivot_longer(
    cols = `Alle Næringer`:Uoppgitt,
    names_to = "Næring",
    values_to = "Ansatte")
```

```{r Næring_Total_Hardanger_Arbeidsted}
har_arb_long %>% 
  filter(knavn %in% c("Odda", "Ullensvang")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. 15: Hardanger: Odda og Ullensvang", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

```{r Næringsfordeling_og_Utvikling_Hardanger_Arbeidssted}
har_arb_long %>% 
  filter(knavn %in% c("Odda", "Ullensvang")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Fig. 16: Hardanger: Odda, Ullensvang", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom')
```
Ullensvang kommune har stor kraftproduksjon og hovednæringen er industri. Majoriteten av kraftproduksjonen foregår i tidligere Odda. Odda er et ensidig industristed, men har også en maritim næring i tillegg. I figur 16 ser vi at industrinæringen utgjør en betraktelig større andel av sysselsettingen i her. Industrinæringen er også omfattet og bygg- og anleggsvirksomhet. På motsatt side er jordbruk, helse- og sosialtjenester dominerende i Ullensvang. 

**Generelt om Ullensvang kommune**

Ullensvang kommune (med Odda) har hatt en jevn og negativ befolkningsvekst i mange tiår. Det gjenspeiles ikke tydelig i våre modeller på grunn av skalaen som er brukt. I tillegg har vi ikke hensyntatt innvandrende arbeidere, eller midlertidige fraflyttede som for eksempel studenter.

# 2 

Finner lokaliseringskvotienter for ulike næringer i ulike kommuner, og for regionen samlet

```{r}
#ordner etter kommunenavn og år
tmp <- syssel_bos
```


```{r}
hau20 <- syssel_bos %>% 
  filter(aar == "2020", knavn == "Haugesund")
```

```{r}
(hau20$Industri/hau20$`Alle Næringer`)
1905/18137
```

```{r}
syssel_bos <- syssel_bos %>% 
  mutate(Eir_Er_industri = Industri/`Alle Næringer`,
         Eir_Er_Jordbruk = `Jordbruk, Skogbrug og Fiske`/`Alle Næringer`,
         Eir_Er_Undervisning = Undervisning/`Alle Næringer`,
         Eir_Er_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`)
```


```{r}
library(readxl)
nasjonalt_bosted <- read_excel("Data/nasjonalt_bosted.xlsx")
```

```{r}
nasjonalt_bosted <- nasjonalt_bosted %>% 
  mutate(Ein_En_Industri = Industri/`Alle Næringer`,
         Ein_En_Jordbruk = `Jordbruk, Skogbruk og Fiske`/`Alle Næringer`,
         Ein_En_Undervisning = Undervisning/`Alle Næringer`,
         Ein_En_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`)
```

```{r, include=FALSE}
# Forelår å være litt mer forsiktig her. syssel_bos$Eir_Er_industri har lengde 207
# 13*15 + 12 (den siste Odda). nasjonalt_bosted$Ein_En_Industri har lengde 13
# Koden her forutsetter at nasjonalt_bosted$Ein_En_Industri kan replikeres 16
# ganger. Risky i utgangspunktet og her går det galt pga. Odda med 12 obs.
# Medfører at resultatet blir galt etter Odda. Foreslår å ta det mer stegvis slik at
# en gar mer kontroll

LQindustri <- syssel_bos %>% 
  select(aar, knavn, Eir_Er_industri) %>% 
  mutate(aar = as.character(aar)) %>% 
  left_join(select(.data = nasjonalt_bosted, aar, Ein_En_Industri), by = c("aar")) %>% 
  mutate(
  andel = Eir_Er_industri/Ein_En_Industri
  )

# Disse må fikses på tilsvarende vis. Har feil verdier slik de er nå 
LQjordbruk <- as_tibble(syssel_bos$Eir_Er_Jordbruk/nasjonalt_bosted$Ein_En_Jordbruk)
LQundervisning <- as_tibble(syssel_bos$Eir_Er_Undervisning/nasjonalt_bosted$Ein_En_Undervisning)
LQhelse <- as_tibble(syssel_bos$Eir_Er_Helse/nasjonalt_bosted$Ein_En_Helse)
```

```{r}
syssel_bos <- syssel_bos %>% 
  mutate(LQindustri = LQindustri$andel,
         LQjordbruk = LQjordbruk,
         LQundervisning = LQundervisning,
         LQhelse = LQhelse)
```


```{r}
LQbos <- syssel_bos %>% 
  select(aar, knavn, LQindustri, LQjordbruk, LQundervisning, LQhelse)
```

For region Haugaland:

```{r}
hld_bos_LQ <- hld_bos %>% 
  mutate(Eir_Er_industri = Industri/`Alle Næringer`,
         Eir_Er_Jordbruk = `Jordbruk, Skogbruk og Fiske`/`Alle Næringer`,
         Eir_Er_Undervisning = Undervisning/`Alle Næringer`,
         Eir_Er_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`)
```

```{r}
LQindustri_hld <- as_tibble(hld_bos_LQ$Eir_Er_industri/nasjonalt_bosted$Ein_En_Industri)
LQjordbruk_hld <- as_tibble(hld_bos_LQ$Eir_Er_Jordbruk/nasjonalt_bosted$Ein_En_Jordbruk)
LQundervisning_hld <- as_tibble(hld_bos_LQ$Eir_Er_Undervisning/nasjonalt_bosted$Ein_En_Undervisning)
LQhelse_hld <- as_tibble(hld_bos_LQ$Eir_Er_Helse/nasjonalt_bosted$Ein_En_Helse)
```

```{r}
hld_bos_LQ <- hld_bos_LQ %>% 
  mutate(LQindustri = LQindustri_hld$value,
         LQjordbruk = LQjordbruk_hld$value,
         LQundervisning = LQundervisning_hld$value,
         LQhelse = LQhelse_hld$value) %>% 
  select(År, LQindustri, LQjordbruk, LQundervisning, LQhelse)
```

For Sunnhordaland:

```{r}
sun_bos_LQ <- sun_bos %>% 
  mutate(Eir_Er_industri = Industri/`Alle Næringer`,
         Eir_Er_Jordbruk = `Jordbruk, Skogbruk og Fiske`/`Alle Næringer`,
         Eir_Er_Undervisning = Undervisning/`Alle Næringer`,
         Eir_Er_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`)
```

```{r}
LQindustri_sun <- as_tibble(sun_bos_LQ$Eir_Er_industri/nasjonalt_bosted$Ein_En_Industri)
LQjordbruk_sun <- as_tibble(sun_bos_LQ$Eir_Er_Jordbruk/nasjonalt_bosted$Ein_En_Jordbruk)
LQundervisning_sun <- as_tibble(sun_bos_LQ$Eir_Er_Undervisning/nasjonalt_bosted$Ein_En_Undervisning)
LQhelse_sun <- as_tibble(sun_bos_LQ$Eir_Er_Helse/nasjonalt_bosted$Ein_En_Helse)
```

```{r}
sun_bos_LQ <- sun_bos_LQ %>% 
  mutate(LQindustri = LQindustri_sun$value,
         LQjordbruk = LQjordbruk_sun$value,
         LQundervisning = LQundervisning_sun$value,
         LQhelse = LQhelse_sun$value) %>% 
  select(År, LQindustri, LQjordbruk, LQundervisning, LQhelse)
```

For Hardanger:

```{r}
har_bos_LQ <- har_bos %>% 
  mutate(Eir_Er_industri = Industri/`Alle Næringer`,
         Eir_Er_Jordbruk = `Jordbruk, Skogbruk og Fiske`/`Alle Næringer`,
         Eir_Er_Undervisning = Undervisning/`Alle Næringer`,
         Eir_Er_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`)
```

```{r}
LQindustri_har <- as_tibble(har_bos_LQ$Eir_Er_industri/nasjonalt_bosted$Ein_En_Industri)
LQjordbruk_har <- as_tibble(har_bos_LQ$Eir_Er_Jordbruk/nasjonalt_bosted$Ein_En_Jordbruk)
LQundervisning_har <- as_tibble(har_bos_LQ$Eir_Er_Undervisning/nasjonalt_bosted$Ein_En_Undervisning)
LQhelse_har <- as_tibble(har_bos_LQ$Eir_Er_Helse/nasjonalt_bosted$Ein_En_Helse)
```

```{r}
har_bos_LQ <- har_bos_LQ %>% 
  mutate(LQindustri = LQindustri_har$value,
         LQjordbruk = LQjordbruk_har$value,
         LQundervisning = LQundervisning_har$value,
         LQhelse = LQhelse_hld$value) %>% 
  select(År, LQindustri, LQjordbruk, LQundervisning, LQhelse)
```


# 3 Sysselsetting i ulike næringer, etter bosted (Modeller under arbeid)

## Haugalandet

```{r Bosted_Haugalandet_1}
hld_bos %>% 
  ggplot(mapping = aes(x = År, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Haugalandet")+
  ylab("Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+
  scale_x_continuous(breaks = seq(2008, 2020, by = 1))
```

```{r Bosted_Haugalandet_2}
syssel_bos %>% 
  filter(knr %in% c(1106, 1135, 1145, 1146, 1149, 1151, 1160)) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = `Alle Næringer`, (angle=0))) +
  scale_fill_distiller(palette = "Dark2") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  labs(title = "Haugalandet", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+
  theme(legend.position = 'bottom')
```

```{r hld_bos_long}
hld_bos_long <- syssel_bos %>%
  pivot_longer(
    cols = `Alle Næringer`:Uoppgitt,
    names_to = "Næring",
    values_to = "Ansatte")
```

```{r Næring_Total_Haugalandet_3_Største_Bosted}
hld_bos_long %>% 
  filter(knavn %in% c("Haugesund", "Karmøy", "Vindafjord")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. x: Haugalandet: Haugesund, Karmøy og Vindafjord", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom')
```

```{r Næring_Total_Haugalandet_4_Minste_Bosted}
hld_bos_long %>% 
  filter(knavn %in% c("Bokn", "Sauda", "Tysvær", "Utsira")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. x: Haugalandet: Bokn, Sauda Tysvær og Utsira", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

```{r Næringsfordeling_og_Utvikling_Haugelandet_3_Største_Bosted}
hld_bos_long %>% 
  filter(knavn %in% c("Haugesund", "Karmøy", "Vindafjord")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Haugalandet: Haugesund, Karmøy og Vindafjord", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom')
```

```{r Næringsfordeling_og_Utvikling_Haugelandet_4_Minste_Bosted}
hld_bos_long %>% 
  filter(knavn %in% c("Bokn", "Sauda", "Tysvær", "Utsira")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Haugalandet: Bokn, Sauda, Tysvær og Utsira", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

## Sunnhordland

```{r Bosted_Sunnhordland_1}
sun_bos %>% 
  ggplot(mapping = aes(x = År, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Sunnhordaland", x = "År", y = "Antall ansatte i  \n alle næringer") +
  theme(axis.title.y = element_text(angle=0))+ 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1))
```

```{r Bosted_Sunnhordland_2}
syssel_bos %>% 
  filter(knr %in% c(4611, 4612, 4613, 4614, 4615, 4616, 4617)) %>% 
  ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  scale_fill_distiller(palette = "Dark2") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
   labs(title = "Sunnhordland", x = "År") +
  theme(legend.position = 'bottom')
```

```{r sun_bos_long}
sun_bos_long <- syssel_bos %>%
  pivot_longer(
    cols = `Alle Næringer`:Uoppgitt,
    names_to = "Næring",
    values_to = "Ansatte")
```

```{r Næring_Total_Sunnhordland_3_Største_Bosted}
sun_bos_long %>% 
  filter(knavn %in% c("Bømlo", "Kvinnherad", "Stord")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. x: Sunnhordland: Bømlo, Kvinnherad og Stord", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom')
```

```{r Næring_Total_Sunnhordland_4_Minste_Bosted}
sun_bos_long %>% 
  filter(knavn %in% c("Etne", "Fitjar", "Sveio", "Tysnes")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. x: Sunnhordland: Etne, Fithar, Sveio og Tysnes", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

```{r Næringsfordeling_og_Utvikling_Sunnhordland_3_Største_Bosted}
sun_bos_long %>% 
  filter(knavn %in% c("Bømlo", "Stord", "Kvinnherad")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Sunnhordland: Bømlo, Kvinnherad og Stord", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 3) +
  theme(legend.position = 'bottom')
```

```{r Næringsfordeling_og_Utvikling_Sunnhordland_4_Minste_Bosted}
sun_bos_long %>% 
  filter(knavn %in% c("Etne", "Sveio", "Fitjar", "Tysnes")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Sunnhordland: Etne, Fitjar, Sveio og Tysnes", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

## Hardanger

```{r Bosted_Hardanger_1}
har_bos %>% 
  ggplot(mapping = aes(x = År, y = `Alle Næringer`)) +
  geom_line() +
  labs(title = "Hardanger", y= "Alle Næringer") + 
  scale_x_continuous(breaks = seq(2008, 2020, by = 1))
```

```{r Bosted_Hardanger_2}
syssel_bos %>% 
  filter(knr %in% c(4618, 1228)) %>% 
  ggplot(mapping = aes(x = aar, y = `Alle Næringer`)) +
  scale_fill_distiller(palette = "Dark2") +
  geom_line(aes(group = knavn, colour = knavn)) +
  scale_color_manual(values=c('#111111','#054987')) +
  scale_size_manual(values = c(seq(2.0, 2, by = -0.1))) +
  geom_hline(yintercept = 0) +
  scale_x_continuous(breaks = seq(2008, 2020, by = 1)) +
   labs(title = "Hardanger", x = "År") +
  theme(legend.position = 'bottom')
```

```{r har_bos_long}
har_bos_long <- syssel_bos %>%
  pivot_longer(
    cols = `Alle Næringer`:Uoppgitt,
    names_to = "Næring",
    values_to = "Ansatte")
```

```{r Næring_Total_Hardanger_Bosted}
har_bos_long %>% 
  filter(knavn %in% c("Odda", "Ullensvang")) %>% 
  filter(Næring %in% "Alle Næringer") %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_color_viridis(discrete = TRUE, option = "A") +
  labs(title = "Fig. x: Hardanger: Odda og Ullensvang", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

```{r Næringsfordeling_og_Utvikling_Hardanger_Bosted}
har_bos_long %>% 
  filter(knavn %in% c("Odda", "Ullensvang")) %>% 
  filter(Næring %in% c("Industri", "Helse- og Sosialtjenester", "Finansiering og Forsikring", "Elektrisitet, Vann og Renovasjon", "Bygge- og Anleggsvirksomhet", "Jordbruk, Skogbrug og Fiske")) %>% 
  ggplot(mapping = aes(x = as.Date(paste0(aar, "-01-01")), y = Ansatte)) +
  scale_fill_distiller(palette = "Dark2") +
  labs(title = "Hardanger: Odda, Ullensvang", x = "År", y = "Antall ansatte") +
  geom_line(mapping = aes(group = Næring, colour = Næring)) +
  facet_wrap(facets = ~ knavn, scales = "free_y", ncol = 2) +
  theme(legend.position = 'bottom')
```

# 3.1 Lokaliseringskvotienter (Venter på svar frå Inge ang. GINI-verdiar.)

```{r}
library(readxl)
nasjonalt_arbeidssted <- read_excel("Data/nasjonalt_arbeidssted.xlsx")
```

## Lokaliseringskvotienter for regionene samlet (Må til litt meir arbeid endo)

### Haugalandet 2008-2020

- Eir_Er_Jordbruk = Samlet sysselsetting i region Haugalandet
- Eir_Er_Industri = Samlet sysselsetting innen Industri-sektoren i region Haugalandet
- Eir_Er_El_Vann_Reno = Samlet sysselsetting innen Eleketrisitet, Vann og Renovasjon-sektoren i region Haugalandet
- Eir_Er_Bygg_og_Anlegg = Samlet sysselsetting innen Bygge- og Anleggsvirksomhet-sektoren i region Haugalandet
- Eir_Er_Finans = Samlet sysselsetting innen Finansiering og Forsikring-sektoren i region Haugalandet
- Eir_Er_Undervisning = Samlet sysselsetting innen Undervisning-sektoren i region Haugalandet
- Eir_Er_Helse = Samlet sysselsetting innen Helse- og Sosialtjenester-sektoren i region Haugalandet

```{r hld_industri}
hld_arb_LQ <- hld_arb %>% 
  # Slik finner vi samlet sysselsetting i Industri i Haugelandet for år 2008-2020
  mutate(Eir_Er_Jordbruk = `Jordbruk, Skogbruk og Fiske`/`Alle Næringer`,
         Eir_Er_Industri = Industri/`Alle Næringer`,
         Eir_Er_El_Vann_Reno = `Elektrisitet, Vann og Renovasjon`/`Alle Næringer`,
         Eir_Er_Bygg_og_Anlegg = `Bygge- og Annleggsvirksomhet`/`Alle Næringer`,
         Eir_Er_Finans = `Finansiering og Forsikring`/`Alle Næringer`,
         Eir_Er_Undervisning = Undervisning/`Alle Næringer`,
         Eir_Er_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`) %>% 
  select(År, `Alle Næringer`, Eir_Er_Jordbruk, Eir_Er_Industri, Eir_Er_El_Vann_Reno, Eir_Er_Bygg_og_Anlegg, Eir_Er_Finans, Eir_Er_Undervisning, Eir_Er_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(hld_arb_LQ,
             col.names = c("År",
                           "Alle",
                           "Jordbruk",
                           "Industri",
                           "Vann",
                           "Bygg",
                           "Finans",
                           "Underv.",
                           "Helse")) %>%
  add_header_above(c("Lokalkvotient, region: Haugalandet"=9))
```

```{r}
hld_arb_GINI <- hld_arb %>% 
  mutate(
    GINI_Primær = ((hld_arb$`Jordbruk, Skogbruk og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - hld_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((hld_arb$Industri/nasjonalt_arbeidssted$Industri - hld_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((hld_arb$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - hld_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
hld_arb_GINI <- hld_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / hld_arb$`Jordbruk, Skogbruk og Fiske` / hld_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / hld_arb$Industri / hld_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / hld_arb$`Helse- og Sosialtjenester`/hld_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(hld_arb_GINI,
             col.names = c("År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=2, "GINI" = 3, "RDI" = 3)) %>%
  add_header_above(c("Haugalandet"=8))
```

#### Kommunenivå på Haugalandet (Haugesund, Karmøy, Tysvær og Bokn)

##### Haugesund

```{r}
Haug_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "1106")
```

```{r}
names(Haug_arb_GINI)[[5]] <- "År"
```

```{r}
Haug_arb_GINI <- Haug_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Haug_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Haug_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Haug_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Haug_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Haug_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Haug_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Haug_arb_GINI <- Haug_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Haug_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Haug_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Haug_arb_GINI$Industri / Haug_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Haug_arb_GINI$`Helse- og Sosialtjenester`/Haug_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Haug_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>% 
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Haugesund"=9))
```

##### Bokn

```{r}
Bokn_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "1145")
```

```{r}
names(Bokn_arb_GINI)[[5]] <- "År"
```

```{r}
Bokn_arb_GINI <- Bokn_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Bokn_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Bokn_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Bokn_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Bokn_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Bokn_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Bokn_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Bokn_arb_GINI <- Bokn_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Bokn_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Bokn_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Bokn_arb_GINI$Industri / Bokn_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Bokn_arb_GINI$`Helse- og Sosialtjenester`/Bokn_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Bokn_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Bokn"=9))
```

##### Tysvær

```{r}
Tysv_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "1146")
```

```{r}
names(Tysv_arb_GINI)[[5]] <- "År"
```

```{r}
Tysv_arb_GINI <- Tysv_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Tysv_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Tysv_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Tysv_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Tysv_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Tysv_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Tysv_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Tysv_arb_GINI <- Tysv_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Tysv_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Tysv_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Tysv_arb_GINI$Industri / Tysv_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Tysv_arb_GINI$`Helse- og Sosialtjenester`/Tysv_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Tysv_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Tysvær"=9))
```

##### Karmøy

```{r}
Karm_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "1149")
```

```{r}
names(Karm_arb_GINI)[[5]] <- "År"
```

```{r}
Karm_arb_GINI <- Karm_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Karm_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Karm_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Karm_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Karm_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Karm_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Karm_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Karm_arb_GINI <- Karm_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Karm_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Karm_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Karm_arb_GINI$Industri / Karm_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Karm_arb_GINI$`Helse- og Sosialtjenester`/Karm_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Karm_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Karmøy"=9))
```


### Sunnhordland 2008-2020

- Eir_Er_Jordbruk = Samlet sysselsetting i region Sunnhordland
- Eir_Er_Industri = Samlet sysselsetting innen Industri-sektoren i region Sunnhordland
- Eir_Er_El_Vann_Reno = Samlet sysselsetting innen Eleketrisitet, Vann og Renovasjon-sektoren i region Sunnhordland
- Eir_Er_Bygg_og_Anlegg = Samlet sysselsetting innen Bygge- og Anleggsvirksomhet-sektoren i region Sunnhordland
- Eir_Er_Finans = Samlet sysselsetting innen Finansiering og Forsikring-sektoren i region Sunnhordland
- Eir_Er_Undervisning = Samlet sysselsetting innen Undervisning-sektoren i region Sunnhordland
- Eir_Er_Helse = Samlet sysselsetting innen Helse- og Sosialtjenester-sektoren i region Sunnhordland

```{r sun_industri}
sun_arb_LQ <- sun_arb %>% 
  # Slik finner vi samlet sysselsetting i Industri i Sunnhordland for år 2008-2020
  mutate(Eir_Er_Jordbruk = `Jordbruk, Skogbruk og Fiske`/`Alle Næringer`,
         Eir_Er_Industri = Industri/`Alle Næringer`,
         Eir_Er_El_Vann_Reno = `Elektrisitet, Vann og Renovasjon`/`Alle Næringer`,
         Eir_Er_Bygg_og_Anlegg = `Bygge- og Annleggsvirksomhet`/`Alle Næringer`,
         Eir_Er_Finans = `Finansiering og Forsikring`/`Alle Næringer`,
         Eir_Er_Undervisning = Undervisning/`Alle Næringer`,
         Eir_Er_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`) %>% 
  select(År, `Alle Næringer`, Eir_Er_Jordbruk, Eir_Er_Industri, Eir_Er_El_Vann_Reno, Eir_Er_Bygg_og_Anlegg, Eir_Er_Finans, Eir_Er_Undervisning, Eir_Er_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(sun_arb_LQ,
             col.names = c("År",
                           "Alle",
                           "Jordbruk",
                           "Industri",
                           "Vann",
                           "Bygg",
                           "Finans",
                           "Underv.",
                           "Helse")) %>%
  add_header_above(c("Lokalkvotienten, region: Sunnhordland"=9))
```

```{r}
sun_arb_GINI <- sun_arb %>% 
  mutate(
    GINI_Primær = ((sun_arb$`Jordbruk, Skogbruk og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - sun_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((sun_arb$Industri/nasjonalt_arbeidssted$Industri - sun_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((sun_arb$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - sun_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
sun_arb_GINI <- sun_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / sun_arb$`Jordbruk, Skogbruk og Fiske` / sun_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    RDI_Industri = 1 / sun_arb$Industri / sun_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    RDI_Helse = 1 / sun_arb$`Helse- og Sosialtjenester`/sun_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(sun_arb_GINI,
             col.names = c("År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=2, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Region: Sunnhordland"=8))
```

#### Kommunenivå i Sunnhordland (Stord, Kvinnherad, Bømlo og Sveio)

##### Stord

```{r}
Stord_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "4614")
```

```{r}
names(Stord_arb_GINI)[[5]] <- "År"
```

```{r}
Stord_arb_GINI <- Stord_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Stord_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Stord_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Stord_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Stord_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Stord_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Stord_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Stord_arb_GINI <- Stord_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Stord_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Stord_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Stord_arb_GINI$Industri / Stord_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Stord_arb_GINI$`Helse- og Sosialtjenester`/Stord_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Stord_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Stord"=9))
```

##### Kvinnherad

```{r}
Kvinn_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "4617")
```

```{r}
names(Kvinn_arb_GINI)[[5]] <- "År"
```

```{r}
Kvinn_arb_GINI <- Kvinn_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Kvinn_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Kvinn_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Kvinn_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Kvinn_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Kvinn_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Kvinn_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Kvinn_arb_GINI <- Kvinn_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Kvinn_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Kvinn_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Kvinn_arb_GINI$Industri / Kvinn_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Kvinn_arb_GINI$`Helse- og Sosialtjenester`/Kvinn_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Kvinn_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Kvinnherad"=9))
```

##### Bømlo

```{r}
Bømlo_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "4613")
```

```{r}
names(Bømlo_arb_GINI)[[5]] <- "År"
```

```{r}
Bømlo_arb_GINI <- Bømlo_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Bømlo_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Bømlo_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Bømlo_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Bømlo_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Bømlo_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Bømlo_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Bømlo_arb_GINI <- Bømlo_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Bømlo_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Bømlo_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Bømlo_arb_GINI$Industri / Bømlo_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Bømlo_arb_GINI$`Helse- og Sosialtjenester`/Bømlo_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Bømlo_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Bømlo"=9))
```

##### Sveio

```{r}
Sveio_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "4612")
```

```{r}
names(Sveio_arb_GINI)[[5]] <- "År"
```

```{r}
Sveio_arb_GINI <- Sveio_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Sveio_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Sveio_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Sveio_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Sveio_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Sveio_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Sveio_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Sveio_arb_GINI <- Sveio_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Sveio_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Sveio_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Sveio_arb_GINI$Industri / Sveio_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Sveio_arb_GINI$`Helse- og Sosialtjenester`/Sveio_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Sveio_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Sveio"=9))
```

### Hardanger 2008-2020

- Eir_Er_Jordbruk = Samlet sysselsetting i region Hardanger
- Eir_Er_Industri = Samlet sysselsetting innen Industri-sektoren i region Hardanger
- Eir_Er_El_Vann_Reno = Samlet sysselsetting innen Eleketrisitet, Vann og Renovasjon-sektoren i region Hardanger
- Eir_Er_Bygg_og_Anlegg = Samlet sysselsetting innen Bygge- og Anleggsvirksomhet-sektoren i region Hardanger
- Eir_Er_Finans = Samlet sysselsetting innen Finansiering og Forsikring-sektoren i region Hardanger
- Eir_Er_Undervisning = Samlet sysselsetting innen Undervisning-sektoren i region Hardanger
- Eir_Er_Helse = Samlet sysselsetting innen Helse- og Sosialtjenester-sektoren i region Hardanger

```{r har_industri}
har_arb_LQ <- har_arb %>% 
  # Slik finner vi samlet sysselsetting i Industri i Hardanger for år 2008-2020
  mutate(Eir_Er_Jordbruk = `Jordbruk, Skogbruk og Fiske`/`Alle Næringer`,
         Eir_Er_Industri = Industri/`Alle Næringer`,
         Eir_Er_El_Vann_Reno = `Elektrisitet, Vann og Renovasjon`/`Alle Næringer`,
         Eir_Er_Bygg_og_Anlegg = `Bygge- og Annleggsvirksomhet`/`Alle Næringer`,
         Eir_Er_Finans = `Finansiering og Forsikring`/`Alle Næringer`,
         Eir_Er_Undervisning = Undervisning/`Alle Næringer`,
         Eir_Er_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`) %>% 
  select(År, `Alle Næringer`, Eir_Er_Jordbruk, Eir_Er_Industri, Eir_Er_El_Vann_Reno, Eir_Er_Bygg_og_Anlegg, Eir_Er_Finans, Eir_Er_Undervisning, Eir_Er_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(har_arb_LQ,
             col.names = c("År",
                           "Alle",
                           "Jordbruk",
                           "Industri",
                           "Vann",
                           "Bygg",
                           "Finans",
                           "Underv.",
                           "Helse")) %>%
  add_header_above(c("Lokalkvotient, region: Hardanger"=9))
```

```{r}
har_arb_GINI <- har_arb %>% 
  mutate(
    GINI_Primær = ((har_arb$`Jordbruk, Skogbruk og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - har_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((har_arb$Industri/nasjonalt_arbeidssted$Industri - har_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((har_arb$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - har_arb$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
har_arb_GINI <- har_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / har_arb$`Jordbruk, Skogbruk og Fiske` / har_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    RDI_Industri = 1 / har_arb$Industri / har_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    RDI_Helse = 1 / har_arb$`Helse- og Sosialtjenester`/har_arb$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`)  %>%
  
  select(År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(har_arb_GINI,
             col.names = c("År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=2, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Region: Hardanger"=8))
```

#### Kommunenivå i Hardanger (Odda og Ullensvang)

##### Odda

```{r}
nasjo_arb_red <- nasjonalt_arbeidssted %>% 
  filter(aar %in% c(2008:2019))
```

```{r}
Odda_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "1228")
```

```{r}
names(Odda_arb_GINI)[[5]] <- "År"
```

```{r}
Odda_arb_GINI <- Odda_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Odda_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjo_arb_red$`Jordbruk, Skogbruk og Fiske` - Odda_arb_GINI$`Alle Næringer`/nasjo_arb_red$`Alle Næringer`)^2),
    
    GINI_Industri = ((Odda_arb_GINI$Industri/nasjo_arb_red$Industri - Odda_arb_GINI$`Alle Næringer`/nasjo_arb_red$`Alle Næringer`)^2),
    
    GINI_Helse = ((Odda_arb_GINI$`Helse- og Sosialtjenester`/nasjo_arb_red$`Helse- og Sosialtjenester` - Odda_arb_GINI$`Alle Næringer`/nasjo_arb_red$`Alle Næringer`)^2))
```

```{r}
Odda_arb_GINI <- Odda_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Odda_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Odda_arb_GINI$`Alle Næringer` -
  nasjo_arb_red$`Jordbruk, Skogbruk og Fiske` / nasjo_arb_red$`Alle Næringer`,
    
    RDI_Industri = 1 / Odda_arb_GINI$Industri / Odda_arb_GINI$`Alle Næringer` -
  nasjo_arb_red$Industri / nasjo_arb_red$`Alle Næringer`,
    
    RDI_Helse = 1 / Odda_arb_GINI$`Helse- og Sosialtjenester`/Odda_arb_GINI$`Alle Næringer` -
  nasjo_arb_red$`Helse- og Sosialtjenester`/nasjo_arb_red$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Odda_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Odda(-2019)"=9))
```

##### Ullensvang

```{r}
Ullen_arb_GINI <- syssel_arb %>% 
  filter(knr %in% "4618")
```

```{r}
names(Ullen_arb_GINI)[[5]] <- "År"
```

```{r}
Ullen_arb_GINI <- Ullen_arb_GINI %>% 
  mutate(
    GINI_Primær = ((Ullen_arb_GINI$`Jordbruk, Skogbrug og Fiske`/nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` - Ullen_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Industri = ((Ullen_arb_GINI$Industri/nasjonalt_arbeidssted$Industri - Ullen_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2),
    
    GINI_Helse = ((Ullen_arb_GINI$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Helse- og Sosialtjenester` - Ullen_arb_GINI$`Alle Næringer`/nasjonalt_arbeidssted$`Alle Næringer`)^2))
```

```{r}
Ullen_arb_GINI <- Ullen_arb_GINI %>% 
  mutate(
    RDI_Primær = 1 / Ullen_arb_GINI$`Jordbruk, Skogbrug og Fiske` / Ullen_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Jordbruk, Skogbruk og Fiske` / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Industri = 1 / Ullen_arb_GINI$Industri / Ullen_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$Industri / nasjonalt_arbeidssted$`Alle Næringer`,
    
    RDI_Helse = 1 / Ullen_arb_GINI$`Helse- og Sosialtjenester`/Ullen_arb_GINI$`Alle Næringer` -
  nasjonalt_arbeidssted$`Helse- og Sosialtjenester`/nasjonalt_arbeidssted$`Alle Næringer`) %>% 
  
  select(knr, År, `Alle Næringer`, GINI_Primær, GINI_Industri, GINI_Helse, RDI_Primær, RDI_Industri, RDI_Helse) %>% 
  mutate_if(is.numeric, round, digits=6)
```

```{r}
kable(Ullen_arb_GINI,
             col.names = c("Knr",
                           "År",
                           "Alle",
                           "Primær",
                           "Industri",
                           "Helse",
                           "Primær",
                           "Industri",
                           "Helse")) %>%
  add_header_above(c(" "=3, "GINI" = 3, "RDI" = 3)) %>% 
  add_header_above(c("Ullensvang"=9))
```

## Nasjonalt??

```{r}
syssel_arb <- syssel_arb %>% 
  mutate(Eir_Er_Jordbruk = `Jordbruk, Skogbrug og Fiske`/`Alle Næringer`,
         Eir_Er_Industri = Industri/`Alle Næringer`,
         Eir_Er_El_Vann_Reno = `Elektrisitet, Vann og Renovasjon`/`Alle Næringer`,
         Eir_Er_Bygg_og_Anlegg = `Bygge- og Anleggsvirksomhet`/`Alle Næringer`,
         Eir_Er_Finans = `Finansiering og Forsikring`/`Alle Næringer`,
         Eir_Er_Undervisning = Undervisning/`Alle Næringer`,
         Eir_Er_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`)
```

```{r}
nasjonalt_arbeidssted <- nasjonalt_arbeidssted %>% 
  mutate(Ein_En_Jordbruk = `Jordbruk, Skogbruk og Fiske`/`Alle Næringer`,
         Ein_En_Industri = Industri/`Alle Næringer`,
         Ein_En_El_Vann_Reno = `Elektrisitet, Vann og Renovasjon`/`Alle Næringer`,
         Ein_En_Bygg_og_Anlegg = `Bygge- og Anleggsvirksomhet`/`Alle Næringer`,
         Ein_En_Finans = `Finansiering og Forsikring`/`Alle Næringer`,
         Ein_En_Undervisning = Undervisning/`Alle Næringer`,
         Ein_En_Helse = `Helse- og Sosialtjenester`/`Alle Næringer`)


LQ_arb_Jordbruk <- syssel_arb %>% 
  select(aar, knavn, Eir_Er_Jordbruk) %>% 
  mutate(aar = as.character(aar)) %>% 
  left_join(select(.data = nasjonalt_arbeidssted, aar, Ein_En_Jordbruk), by = c("aar")) %>% 
  mutate(andel = Eir_Er_Jordbruk/Ein_En_Jordbruk)


LQ_arb_Industri <- syssel_arb %>% 
  select(aar, knavn, Eir_Er_Industri) %>% 
  mutate(aar = as.character(aar)) %>% 
  left_join(select(.data = nasjonalt_arbeidssted, aar, Ein_En_Industri), by = c("aar")) %>% 
  mutate(andel = Eir_Er_Industri/Ein_En_Industri)


LQ_arb_El_Vann_Reno <- syssel_arb %>% 
  select(aar, knavn, Eir_Er_El_Vann_Reno) %>% 
  mutate(aar = as.character(aar)) %>% 
  left_join(select(.data = nasjonalt_arbeidssted, aar, Ein_En_El_Vann_Reno), by = c("aar")) %>% 
  mutate(andel = Eir_Er_El_Vann_Reno/Ein_En_El_Vann_Reno)


LQ_arb_Bygg_Anlegg <- syssel_arb %>% 
  select(aar, knavn, Eir_Er_Bygg_og_Anlegg) %>% 
  mutate(aar = as.character(aar)) %>% 
  left_join(select(.data = nasjonalt_arbeidssted, aar, Ein_En_Bygg_og_Anlegg), by = c("aar")) %>% 
  mutate(andel = Eir_Er_Bygg_og_Anlegg/Ein_En_Bygg_og_Anlegg)


LQ_arb_Finans <- syssel_arb %>% 
  select(aar, knavn, Eir_Er_Finans) %>% 
  mutate(aar = as.character(aar)) %>% 
  left_join(select(.data = nasjonalt_arbeidssted, aar, Ein_En_Finans), by = c("aar")) %>% 
  mutate(andel = Eir_Er_Finans/Ein_En_Finans)


LQ_arb_Undervisning <- syssel_arb %>% 
  select(aar, knavn, Eir_Er_Undervisning) %>% 
  mutate(aar = as.character(aar)) %>% 
  left_join(select(.data = nasjonalt_arbeidssted, aar, Ein_En_Undervisning), by = c("aar")) %>% 
  mutate(andel = Eir_Er_Undervisning/Ein_En_Undervisning)


LQ_arb_Helse <- syssel_arb %>% 
  select(aar, knavn, Eir_Er_Helse) %>% 
  mutate(aar = as.character(aar)) %>% 
  left_join(select(.data = nasjonalt_arbeidssted, aar, Ein_En_Helse), by = c("aar")) %>% 
  mutate(andel = Eir_Er_Helse/Ein_En_Helse)
```

```{r}
syssel_arb <- syssel_arb %>% 
  mutate(LQ_arb_Jordbruk = LQ_arb_Jordbruk$andel,
         LQ_arb_Industri = LQ_arb_Industri$andel,
         LQ_arb_El_Vann_Reno = LQ_arb_El_Vann_Reno$andel,
         LQ_arb_Bygg_Anlegg = LQ_arb_Bygg_Anlegg$andel,
         LQ_arb_Finans = LQ_arb_Finans$andel,
         LQ_arb_Undervisning = LQ_arb_Undervisning$andel,
         LQ_arb_Helse = LQ_arb_Helse$andel)
```

```{r}
LQ_arb <- syssel_arb %>% 
  select(aar, knavn, LQ_arb_Jordbruk, LQ_arb_Industri, LQ_arb_El_Vann_Reno, LQ_arb_Bygg_Anlegg, LQ_arb_Finans, LQ_arb_Undervisning, LQ_arb_Helse)
```

```{r}
LQ_arb[is.na(LQ_arb)] = 0
```

-

# Pendling

De ulike kommunene og regionene har ulike behov, for at regionene skal utvikle seg er pendling et viktig begrep for å tiltrekke seg arbeidskraft. Veldig mange kommuner har for lite arbeidsplasser i forhold til antall arbeidende innbyggere, som vil si at de fleste er avhengige av pendlere. Pendling kan være til andre kommuner i samme region eller til andre regioner. Alle kommuner har kanskje ikke arbeidsplasser innen alle fagfelt, arbeidstakere er derfor avhengig av å pendler til andre kommuner for å finne relevant arbeid. Det samme gjelder dersom arbeidstaker har tilhørighet til en kommune, men det ikke finnes relevant arbeid da er han også nødt til å søke jobb i andre kommuner. Her kommer begrepene innpendling og utpendling inn, som betyr at noen kommuner eller regioner har flere arbeidsplasser tilgjengelige enn de har innbyggere som kan jobbe innad i kommunen eller at de ikke har nok arbeidsplasser og innbyggerene er nødt til å søke jobb andre plasser. Vi skal se på innpendling og utpendling som vil kunne fortelle oss i hvilken grad et sted er integrert i et større arbeidsmarked https://regionalanalyse.no/rapport/3004/1/4. 

Nedenfor vil vi først ta for oss regionen Haugalandet og Sunnhordland med Ullensvang, og se på disse regionene hver for seg. Så kommer en tabell som tar for seg disse regionene samlet. Vi ønsker først å skille disse to regionene for å se i hvilken kommune andelen av innpendling og utpendling er størst og minst. For så å se på pendlingen mellom regionene. 

Alle tabellene viser 
 

Haugalandsregionen: 

```{r Pendling på Haugalandet}
hgl_Pendling
```
I tabellen over har vi sett på Haugalandsregionen og kommunene som er knyttet til denne regionen er Haugesund, Sauda, Bokn, Tysvær, Karmøy, Utsira og Vindafjord. Tabellen kan forklares på følgende måte:  

I radene kan vi se innpendling. Her kan vi se en andel stillinger som er besatt av arbeidstakere fra andre kommuner i Haugalandsregionen.  

I kolonnene ser vi utpendling. Det vil si arbeidstakere som bor i en kommune, og som har arbeidsted i en annen kommune innenfor Hauglandsregionen.  

De som er markert med gult er arbeidstakere som bor og jobber i samme kommune. 

Haugesund, Karmøy og Tysvær er de kommunene i regionen med høyest andel pendlere både når det gjelder inn- og utpendling. La oss se nærmere på Haugesund som har en stor del av arbeidstakerne i regionen. Det gjelder både når vi ser på innpendling, utpendling og de som bor og jobber i samme kommune. Ut ifra tabellen kan vi se at Haugesund har 11714 arbeidstakere som bor og jobber i kommunen. Fra Haugesund er det eksempelvis 1029 arbeidstakere som pendler til Tysvær og 2586 arbeidstakere som pendler til Karmøy. Til Sauda og Utsira er det en betydelig lavere andel som pendler. Grunnen til at det nok at det er mindre kommuner med færre arbeidsplasser. Mange av de som bor i distriktene som eksempelvis Sauda og Utsira jobber og bor i samme kommune. Vi kan se at i Sauda jobber og bor det 1789 arbeidstaker, mens de har 31 stykk som pendler inn til kommunen og 66 stykk som pendler ut av kommunen. Det kan være flere som pendler inn til og ut av kommunen fra andre regioner, men her ser vi tallene på de som pendler i Haugalandsregionen.  

Vi vet at Haugesund er regionsentrum med sykehus og høgskole. Samtidig har Haugesund flere olje og sjøfartsnæringer.  Det er sentralisert som betyr at det er grunnlag for et større jobbmarked. Det er årsaken til at Haugesund har mer innpendling enn de andre kommunene i regionen. Karmøy og Tysvær som ligger nærmest Haugesund har størst andel utpendling, også til Haugesund.  

```{r Pendling i Sunnhordland}
sun_Pendling
```

-   

```{r siste}
# Siste
```

-   
